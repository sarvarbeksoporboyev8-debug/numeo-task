{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[isRecording,setIsRecording]=useState(false);const[translations,setTranslations]=useState([]);const[targetLanguage,setTargetLanguage]=useState('es');const[error,setError]=useState(null);const[isLoading,setIsLoading]=useState(false);const mediaRecorderRef=useRef(null);const audioChunksRef=useRef([]);const webSocketRef=useRef(null);useEffect(()=>{const protocol=window.location.protocol==='https:'?'wss:':'ws:';const wsUrl=\"\".concat(protocol,\"//\").concat(window.location.hostname,\":3001\");try{webSocketRef.current=new WebSocket(wsUrl);webSocketRef.current.onopen=()=>{console.log('Connected to WebSocket');setError(null);};webSocketRef.current.onerror=()=>{setError('Failed to connect to server');};webSocketRef.current.onmessage=event=>{try{const data=JSON.parse(event.data);if(data.translated){setTranslations([data,...translations]);setIsLoading(false);}}catch(e){console.error('Error parsing message:',e);}};}catch(err){console.error('WebSocket error:',err);setError('Could not connect to server');}},[]);const startRecording=async()=>{try{setError(null);const stream=await navigator.mediaDevices.getUserMedia({audio:true});const mediaRecorder=new MediaRecorder(stream);mediaRecorderRef.current=mediaRecorder;audioChunksRef.current=[];mediaRecorder.ondataavailable=event=>{audioChunksRef.current.push(event.data);};mediaRecorder.onstop=()=>{const audioBlob=new Blob(audioChunksRef.current,{type:'audio/wav'});sendAudioToBackend(audioBlob);};mediaRecorder.start();setIsRecording(true);}catch(err){setError('Microphone access denied');}};const stopRecording=()=>{if(mediaRecorderRef.current&&isRecording){mediaRecorderRef.current.stop();mediaRecorderRef.current.stream.getTracks().forEach(track=>track.stop());setIsRecording(false);setIsLoading(true);}};const sendAudioToBackend=audioBlob=>{if(!webSocketRef.current||webSocketRef.current.readyState!==WebSocket.OPEN){setError('Not connected to server');setIsLoading(false);return;}const reader=new FileReader();reader.onload=()=>{const audioData=reader.result;webSocketRef.current.send(JSON.stringify({type:'audio',audio:audioData,targetLanguage}));};reader.readAsDataURL(audioBlob);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"Title\",children:\"Voice Translation\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red',margin:'10px'},children:error}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:'20px'},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Target Language: \"}),/*#__PURE__*/_jsxs(\"select\",{value:targetLanguage,onChange:e=>setTargetLanguage(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"es\",children:\"Spanish\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fr\",children:\"French\"}),/*#__PURE__*/_jsx(\"option\",{value:\"de\",children:\"German\"}),/*#__PURE__*/_jsx(\"option\",{value:\"zh\",children:\"Chinese\"})]})]}),/*#__PURE__*/_jsx(\"div\",{children:!isRecording?/*#__PURE__*/_jsx(\"button\",{className:\"Button\",onClick:startRecording,disabled:isLoading,children:\"Start Recording\"}):/*#__PURE__*/_jsx(\"button\",{className:\"Button\",onClick:stopRecording,children:\"Stop Recording\"})}),isLoading&&/*#__PURE__*/_jsx(\"p\",{children:\"Processing...\"}),translations.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"Translations\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Translations\"}),translations.map((t,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"Translation\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Original:\"}),\" \",t.original]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Translated:\"}),\" \",t.translated]})]},i))]})]});};export default App;","map":{"version":3,"names":["React","useState","useRef","useEffect","jsx","_jsx","jsxs","_jsxs","App","isRecording","setIsRecording","translations","setTranslations","targetLanguage","setTargetLanguage","error","setError","isLoading","setIsLoading","mediaRecorderRef","audioChunksRef","webSocketRef","protocol","window","location","wsUrl","concat","hostname","current","WebSocket","onopen","console","log","onerror","onmessage","event","data","JSON","parse","translated","e","err","startRecording","stream","navigator","mediaDevices","getUserMedia","audio","mediaRecorder","MediaRecorder","ondataavailable","push","onstop","audioBlob","Blob","type","sendAudioToBackend","start","stopRecording","stop","getTracks","forEach","track","readyState","OPEN","reader","FileReader","onload","audioData","result","send","stringify","readAsDataURL","className","children","style","color","margin","value","onChange","target","onClick","disabled","length","map","t","i","original"],"sources":["/workspaces/numeo-task/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport './App.css';\n\ninterface Translation {\n  original: string;\n  translated: string;\n  language: string;\n}\n\nconst App: React.FC = () => {\n  const [isRecording, setIsRecording] = useState(false);\n  const [translations, setTranslations] = useState<Translation[]>([]);\n  const [targetLanguage, setTargetLanguage] = useState('es');\n  const [error, setError] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  \n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const audioChunksRef = useRef<Blob[]>([]);\n  const webSocketRef = useRef<WebSocket | null>(null);\n\n  useEffect(() => {\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const wsUrl = `${protocol}//${window.location.hostname}:3001`;\n    \n    try {\n      webSocketRef.current = new WebSocket(wsUrl);\n      \n      webSocketRef.current.onopen = () => {\n        console.log('Connected to WebSocket');\n        setError(null);\n      };\n\n      webSocketRef.current.onerror = () => {\n        setError('Failed to connect to server');\n      };\n\n      webSocketRef.current.onmessage = (event) => {\n        try {\n          const data = JSON.parse(event.data);\n          if (data.translated) {\n            setTranslations([data, ...translations]);\n            setIsLoading(false);\n          }\n        } catch (e) {\n          console.error('Error parsing message:', e);\n        }\n      };\n    } catch (err) {\n      console.error('WebSocket error:', err);\n      setError('Could not connect to server');\n    }\n  }, []);\n\n  const startRecording = async () => {\n    try {\n      setError(null);\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      const mediaRecorder = new MediaRecorder(stream);\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (event) => {\n        audioChunksRef.current.push(event.data);\n      };\n\n      mediaRecorder.onstop = () => {\n        const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/wav' });\n        sendAudioToBackend(audioBlob);\n      };\n\n      mediaRecorder.start();\n      setIsRecording(true);\n    } catch (err) {\n      setError('Microphone access denied');\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n      setIsRecording(false);\n      setIsLoading(true);\n    }\n  };\n\n  const sendAudioToBackend = (audioBlob: Blob) => {\n    if (!webSocketRef.current || webSocketRef.current.readyState !== WebSocket.OPEN) {\n      setError('Not connected to server');\n      setIsLoading(false);\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = () => {\n      const audioData = reader.result as string;\n      webSocketRef.current!.send(JSON.stringify({\n        type: 'audio',\n        audio: audioData,\n        targetLanguage,\n      }));\n    };\n    reader.readAsDataURL(audioBlob);\n  };\n\n  return (\n    <div className=\"App\">\n      <h1 className=\"Title\">Voice Translation</h1>\n      \n      {error && <div style={{color: 'red', margin: '10px'}}>{error}</div>}\n\n      <div style={{margin: '20px'}}>\n        <label>Target Language: </label>\n        <select value={targetLanguage} onChange={(e) => setTargetLanguage(e.target.value)}>\n          <option value=\"es\">Spanish</option>\n          <option value=\"fr\">French</option>\n          <option value=\"de\">German</option>\n          <option value=\"zh\">Chinese</option>\n        </select>\n      </div>\n\n      <div>\n        {!isRecording ? (\n          <button className=\"Button\" onClick={startRecording} disabled={isLoading}>\n            Start Recording\n          </button>\n        ) : (\n          <button className=\"Button\" onClick={stopRecording}>\n            Stop Recording\n          </button>\n        )}\n      </div>\n\n      {isLoading && <p>Processing...</p>}\n\n      {translations.length > 0 && (\n        <div className=\"Translations\">\n          <h2>Translations</h2>\n          {translations.map((t, i) => (\n            <div key={i} className=\"Translation\">\n              <p><strong>Original:</strong> {t.original}</p>\n              <p><strong>Translated:</strong> {t.translated}</p>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}